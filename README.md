[![Build Status](https://dev.azure.com/aasworldwidetelescope/WWT/_apis/build/status/WorldWideTelescope.wwt-webgl-engine?branchName=master)](https://dev.azure.com/aasworldwidetelescope/WWT/_build/latest?definitionId=3&branchName=master)
[![npm](https://img.shields.io/npm/v/@wwtelescope/engine)](https://www.npmjs.com/package/@wwtelescope/engine)

# The AAS WorldWide Telescope WebGL engine

The “WebGL engine” of the [AAS] [WorldWide Telescope][wwt-home] (WWT) is a
JavaScript/[TypeScript] library that powers the Web-based versions of the WWT
visualization software, as exemplified by the [WWT web client][webclient]. It is
published on NPM as [@wwtelescope/engine].

Learn more about WWT [here][wwt-home].

[AAS]: https://aas.org/
[TypeScript]: https://www.typescriptlang.org/
[wwt-home]: https://worldwidetelescope.org/home/
[webclient]: https://worldwidetelescope.org/webclient/
[@wwtelescope/engine]: https://www.npmjs.com/package/@wwtelescope/engine

## Building the engine

The process to build the engine is a bit unusual because the bulk of the code is
actually C# code (in the directory `wwtlib/`, forked from [wwt-windows-client])
that is transpiled into JavaScript using an unreleased version of [ScriptSharp],
an unmaintained package.

[wwt-windows-client]: https://github.com/WorldWideTelescope/wwt-windows-client
[ScriptSharp]: https://github.com/nikhilk/scriptsharp

1. To build the engine starting from the C# source, you need a Windows machine
   with Visual Studio 2017. Other versions of Visual Studio might also work.
1. Open the `WebGLEngine.sln` file and build the project. This should create
   the file `wwtlib/bin/wwtlib.js`
1. The continuous integration infrastructure for this repository will publish
   the `wwtlib.js` file as a build artifact, so if you're not positioned to
   build on a Windows machine, you can obtain this file by looking up the build
   artifacts associated with the latest update to the `master` branch, or
   issuing a pull request if you want to make changes to the C# code.

Once you have obtained the file `wwtlib/bin/wwtlib.js`, the remaining
development tasks all use standard JavaScript tooling, namely [npm]. You need to
install it if it is not already available on your machine.

[npm]: https://www.npmjs.com/get-npm

1. The command `npm run concat-index` will create `src/index.js`, which takes
   the WWT library and turns it into a [UMD-style] JavaScript module.
1. The command `npm run uglify` will create a minified `src/index.min.js`.
1. [TypeScript] definitions are manually maintained in `src/index.d.ts`, so that
   you can use the module with type-checking if you want. The command `npm run
   tscheck` will run the TypeScript compiler, which in this case just checks the
   syntactic validity of the annotations.

[UMD-style]: https://github.com/umdjs/umd

There is a modest but growing test suite in `tests/`.

Documentation is maintained in the `docs/` subdirectory. The documentation is a
Frankenstein combination of narrative material built with the static site
generator [Zola], and autogenerated API documentation created with [TypeDoc].

[Zola]: https://getzola.org/
[TypeDoc]: https://typedoc.org/

1. Zola is fast and self-contained and [ridiculously easy to
   install][install-zola].
1. To build the narrative material, run `zola build` in the `docs` subdirectory.
   This will place the resulting HTML in `docs/public/`.
1. The command `zola check` will check the narrative docs for broken links.
1. To build the API reference, run `npm run doc`, which will place HTML in
   `docs/public/apiref/`.
1. To build both, you need to do a little dance automated in `docs/build.sh`:
   1. Run the Zola build.
   1. Delete `docs/public/apiref/index.html`.
   1. Run the TypeDoc build.
1. To view the documentation, we recommend using a local static file server such
   as `npx http-serve docs/public`.
1. Zola has a built-in server command with auto-reloading, `zola serve`.
   However, since the command deletes and rebuilds the `docs/public` directory,
   if you use it your TypeDoc documentation will be deleted.

[install-zola]: https://www.getzola.org/documentation/getting-started/installation/


## Continuous Integration and Deployment

Merges to the `master` branch will:

- Build and publish the browser-importable engine module to
  <https://web.wwtassets.org/engine/latest/wwtsdk.js>.
- Build and publish the documentation to
  <https://docs.worldwidetelescope.org/webgl-reference/latest/>.

Pushes of Git version tags, having names of the form `vX.Y.Z`, will:

- Build and publish the browser-importable engine module to
  `https://web.wwtassets.org/engine/X.Y.Z/wwtsdk.js`.
- Publish an additional copy of the module to
  `https://web.wwtassets.org/engine/X.Y/wwtsdk.js`
- Build and publish the documentation to
  `https://docs.worldwidetelescope.org/webgl-reference/X.Y/`.
- Publish a new version of [the package][@wwtelescope/engine] on NPM.


## Getting involved

We love it when people get involved in the WWT community! You can get started
by [participating in our user forum] or by
[signing up for our low-traffic newsletter]. If you would like to help make
WWT better, our [Contributor Hub] aims to be your one-stop shop for
information about how to contribute to the project, with the
[Contributors’ Guide] being the first thing you should read. Here on GitHub we
operate with a standard [fork-and-pull] model.

[participating in our user forum]: https://wwt-forum.org/
[signing up for our low-traffic newsletter]: https://bit.ly/wwt-signup
[Contributor Hub]: https://worldwidetelescope.github.io/
[Contributors’ Guide]: https://worldwidetelescope.github.io/contributing/
[fork-and-pull]: https://help.github.com/en/articles/about-collaborative-development-models

All participation in WWT communities is conditioned on your adherence to the
[WWT Code of Conduct], which basically says that you should not be a jerk.

[WWT Code of Conduct]: https://worldwidetelescope.github.io/code-of-conduct/


## Acknowledgments

The AAS WorldWide Telescope system is a [.NET Foundation] project. Work on WWT
has been supported by the [American Astronomical Society] (AAS), the US
[National Science Foundation] (grants [1550701] and [1642446]), the [Gordon
and Betty Moore Foundation], and [Microsoft].

[American Astronomical Society]: https://aas.org/
[.NET Foundation]: https://dotnetfoundation.org/
[National Science Foundation]: https://www.nsf.gov/
[1550701]: https://www.nsf.gov/awardsearch/showAward?AWD_ID=1550701
[1642446]: https://www.nsf.gov/awardsearch/showAward?AWD_ID=1642446
[Gordon and Betty Moore Foundation]: https://www.moore.org/
[Microsoft]: https://www.microsoft.com/


## Legalities

The WWT code is licensed under the [MIT License]. The copyright to the code is
owned by the [.NET Foundation].

[MIT License]: https://opensource.org/licenses/MIT
